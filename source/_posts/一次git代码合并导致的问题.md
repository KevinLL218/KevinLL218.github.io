---
title: 一次git代码合并导致的问题
date: 2023-09-08 15:23:38
categories:
  - 开发相关
tags: [java, git]
---

> 因为一次代码合并失误，导致线上事故，扣了绩效，引以为戒

在一个月前某次发版的时候，使用cherry-pick不熟练，将别人的代码覆盖了，这一个月的时间造成了一些单子多生成了，产生了比较严重的后果，因此将其记录下来。

对一个文件进行修改提交之后，另一个人在修改的基础上再次进行修改，然后等到正式上线的时候，最后修改的先发上去，那么问题来了，如果此时我提交第一次修改到master分支，会如何解决冲突？

这就是这次事故的原因了。 cherry-pick的时候产生了冲突，在解决冲突的时候，使用第一版的代码覆盖了后续的代码。

```java
// change 1    -- committed by A 1:00
// change 2    -- committed by B 2:00
```

如果此时先提交了B，后提交了A，会触发resolve conflict，此时代码是没有B提交，很容易将B代码覆盖，但是如果**隔了几行**，此时提交的顺序就可以改变了. ~~估计是检测了相邻的几行代码~~ 

现阶段对于git的应用还是拉取开发分支到本地，修改后直接提交推送到远程，架构部的推荐方式则是使用多个分支，如`hotfix`,`release`,`feature`等等，分别代表"紧急修补","正式","业务功能"等，但是由于老项目不支持本地启动，因此无法实现这个设想。